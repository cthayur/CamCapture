/*! CamCapture 2015-03-25 */
!function(a){"use strict";window.camCaptureContainer=new a}(window.Hilary),function(a,b){"use strict";a.register({name:"ICamCaptureSettings",dependencies:[],factory:function(){return function(a){var c=this;b.getMedia=b.getUserMedia||b.webkitGetUserMedia||b.mozGetUserMedia||b.msGetUserMedia,c.webRtcAvailable=b.getMedia?!0:!1,c.flashRequired=!c.webRtcAvailable,c.forceFlash=a.forceFlash||!1,c.captureParameters={delay:{rtc:a.delay&&a.delay.rtc||100,flash:a.delay&&a.delay.flash||1},frames:{rtc:a.frames&&a.frames.rtc||50,flash:a.frames&&a.frames.flash||30}},c.relativeSwfLocation=a.relativeSwfLocation||"/src/jscam_canvas_only.swf",c.canvasWidth=a.canvasWidth||320,c.canvasHeight=a.canvasHeight||240,c.displayWidth=a.displayWidth||320,c.displayHeight=a.displayHeight||240,c.getNewCanvas=function(a,b){return'<canvas width="'+a+'" height="'+b+'"/>'},c.videoSelector=a.videoSelector,c.flashVideoSelector=a.flashVideoSelector,c.camAccessSuccess=a.camAccessSuccess||function(){},c.camAccessError=a.camAccessError||function(){}}}})}(window.camCaptureContainer,window.navigator),function(a){"use strict";a.register({name:"ICamCapture",dependencies:[],factory:function(){return function(a){if("function"!=typeof a.ctor)throw new Error("Constructor required on an implementation");if("function"!=typeof a.capture)throw new Error("capture method required on an implementation");if("function"!=typeof a.captureBurst)throw new Error("captureBurst method required on an implementation");if("function"!=typeof a.destroy)throw new Error("destroy method required on an implementation");var b=a.ctor;return b.prototype.capture=a.capture,b.prototype.captureBurst=a.captureBurst,b.prototype.destroy=a.destroy,b}}})}(window.camCaptureContainer),function(a,b,c,d,e){"use strict";a.register({name:"CamCaptureRtc",dependencies:["ICamCapture"],factory:function(a){var f={},g={};return f.ctor=function(a){var d,e,f=this,h=b(a.videoSelector),i=h[0];f.type="RTC",f.destroy(),f.settings=a,f.videoElem=i,h.css("width",a.displayWidth+"px"),h.css("height",a.displayHeight+"px"),d=function(b){if(g=b,c.mozGetUserMedia)i.src=window.URL.createObjectURL(b);else{var d=window.URL||window.webkitURL;i.src=d.createObjectURL(b)}i.play(),a.camAccessSuccess&&"function"==typeof a.camAccessSuccess&&a.camAccessSuccess()},e=function(b){a.camAccessError&&"function"==typeof a.camAccessError&&a.camAccessError(b)},c.getMedia({video:!0,audio:!1},d,e)},f.capture=function(a){var c,d,e=this;d=b(b("<div/>").html(e.settings.getNewCanvas(e.settings.displayWidth,e.settings.displayHeight))).children()[0],d.getContext("2d").drawImage(e.videoElem,0,0,e.settings.displayWidth,e.settings.displayHeight),c=d.toDataURL("image/png"),a&&"function"==typeof a&&a(c)},f.captureBurst=function(a){var b,c=0,f=this,g=[];b=d(function(){f.capture(function(a){g.push(a),c+=1}),c===f.settings.captureParameters.frames.rtc&&(e(b),a&&"function"==typeof a&&a(g))},f.settings.captureParameters.delay.rtc)},f.destroy=function(){g&&g.stop&&g.stop()},new a(f)}})}(window.camCaptureContainer,window.jQuery,window.navigator,window.setInterval,window.clearInterval),function(a,b,c,d,e,f){"use strict";a.register({name:"CamCaptureFlash",dependencies:["ICamCapture"],factory:function(a){var c,g,h={};return h.ctor=function(a){var d=this,e=0,h={};d.type="FLASH",d.settings=a,c(h,a),b(a.flashVideoSelector).show(),b(a.flashVideoSelector).webcam({width:a.displayWidth,height:a.displayHeight,mode:"callback",swffile:a.relativeSwfLocation,onTick:function(){},onSave:function(b){var d,f,i=b.split(";"),j=h.image;for(f=0;f<a.displayWidth;f+=1)d=parseInt(i[f]),j.data[e+0]=d>>16&255,j.data[e+1]=d>>8&255,j.data[e+2]=255&d,j.data[e+3]=255,e+=4;e>=4*a.displayWidth*a.displayHeight&&(h.ctx.putImageData(j,0,0),g&&g(h.canvas.toDataURL("image/png")),c(h,a),e=0)},onCapture:function(){f.save()},debug:function(b,c){"notify"===b&&"Camera started"===c?a.camAccessSuccess():"notify"===b&&"Camera stopped"===c&&a.camAccessError()}})},h.capture=function(a){g=a,f.capture()},h.captureBurst=function(a){var b,c=0,f=this,g=[];b=d(function(){f.capture(function(a){g.push(a),c+=1}),c===f.settings.captureParameters.frames.flash&&(e(b),a&&"function"==typeof a&&a(g))},f.settings.captureParameters.delay.flash)},h.destroy=function(){b(this.settings.flashVideoSelector).hide()},c=function(a,c){a.canvas=b(b("<div/>").html(c.getNewCanvas(c.displayWidth,c.displayHeight))).children()[0],a.ctx=a.canvas.getContext("2d"),a.image=a.ctx.getImageData(0,0,c.displayWidth,c.displayHeight)},new a(h)}})}(window.camCaptureContainer,window.jQuery,window.navigator,window.setInterval,window.clearInterval,window.webcam),function(a){"use strict";a.register({name:"CamCapture",dependencies:["ICamCaptureSettings","CamCaptureRtc","CamCaptureFlash"],factory:function(a,b,c){return function(d){this.name="CamCapture";var e=new a(d);return e.forceFlash||e.flashRequired?new c(e):new b(e)}}})}(window.camCaptureContainer),function(a){"use strict";window.CamCapture=a.resolve("CamCapture")}(window.camCaptureContainer);